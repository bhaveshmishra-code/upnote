---
categories:
- App Script
---
# Google Sheet - Query

## Google Reference

[https://support.google.com/docs/answer/3093343?hl=en](https://support.google.com/docs/answer/3093343?hl=en)  

[https://developers.google.com/chart/interactive/docs/querylanguage](https://developers.google.com/chart/interactive/docs/querylanguage)  

  

  

The syntax of the query language is composed of the following clauses. Each clause starts with one or two keywords. All clauses are optional. Clauses are separated by spaces. The order of the clauses must be as follows:

| Clause | Usage |
| --- | --- |
| `[select](https://developers.google.com/chart/interactive/docs/querylanguage#Select)` | Selects which columns to return, and in what order. If omitted, all of the table's columns are returned, in their default order. |
| `[where](https://developers.google.com/chart/interactive/docs/querylanguage#Where)` | Returns only rows that match a condition. If omitted, all rows are returned. |
| `[group by](https://developers.google.com/chart/interactive/docs/querylanguage#Group_By)` | Aggregates values across rows. |
| `[pivot](https://developers.google.com/chart/interactive/docs/querylanguage#Pivot)` | Transforms distinct values in columns into new columns. |
| `[order by](https://developers.google.com/chart/interactive/docs/querylanguage#Order_By)` | Sorts rows by values in columns. |
| `[limit](https://developers.google.com/chart/interactive/docs/querylanguage#Limit)` | Limits the number of returned rows. |
| `[offset](https://developers.google.com/chart/interactive/docs/querylanguage#Offset)` | Skips a given number of first rows. |
| `[label](https://developers.google.com/chart/interactive/docs/querylanguage#Label)` | Sets column labels. |
| `[format](https://developers.google.com/chart/interactive/docs/querylanguage#Format)` | Formats the values in certain columns using given formatting patterns. |
| `[options](https://developers.google.com/chart/interactive/docs/querylanguage#Options)` | Sets additional options. |

  

## SELECT

Items in a select clause can be column identifiers, or the output of aggregation functions, scalar functions, or operators.

  

## WHERE

The simple comparison operators are <=, <, >, >=, =, !=, <>. Both comparison operators != <> mean not-equal. Strings are compared by lexicographic value. Note that equality is indicated by =, not == as in most computer languages. Comparing to null is done using is null or is not null.

  

You can join multiple conditions using the logical operators and, or, and not. Parentheses can be used to define explicit precedence.

  

## GROUP BY

The `group by` clause is used to aggregate values across rows. A single row is created for each distinct combination of values in the group-by clause. The data is automatically sorted by the grouping columns, unless otherwise specified by an `order by` clause.

**Note:** If you use a `group by` clause, then _every column_ listed in the `select` clause must either be listed in the `group by` clause, or be wrapped by an [aggregation function](https://developers.google.com/chart/interactive/docs/querylanguage#aggregation_functions).

  

## PIVOT

The `pivot` clause is used to transform distinct values in columns into new columns. For example, a pivot by a column 'year' would produce a table with a column for each distinct year that appears in the original table. This could be useful if, for instance, a line chart visualization draws each column as a separate line. If you want to draw a separate line for each year, and 'year' is one of the columns of the original table, then a good option would be to use a pivot operation to do the necessary data transformation.  

  

## AGGREGATE FUNCTION

|     |     |     |     |
| --- | --- | --- | --- |
| `avg()` | Returns the average value of all values in the column for a group. | `number` | `number` |
| `count()` | Returns the count of elements in the specified column for a group. Null cells are not counted. | Any type | `number` |
| `max()` | Returns the maximum value in the column for a group. Dates are compared with earlier being smaller, `string`s are compared alphabetically, with case-sensitivity. | Any type | Same type as column |
| `min()` | Returns the minimum value in the column for a group. Dates are compared with earlier being smaller, `string`s are compared alphabetically, with case-sensitivity | Any type | Same type as column |
| `sum()` | Returns the sum of all values in the column for a group. | `number` | `number` |